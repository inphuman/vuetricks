---
layout: post
title: –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ Vue 3 –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–∞! –í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
tags: [–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, Vue 3]
comments: false
---

## –ß—Ç–æ –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ–¥ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é?

–ë—ã—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –≤ –Ω–∞—à–∏ –¥–Ω–∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –∏–º–µ–µ—Ç–µ –¥–µ–ª–æ —Å —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ –ø–ª–∞–≤–Ω–æ–µ
—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ DOM. –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç—Ä–∞–∂–µ–Ω–æ –≤ DOM
–±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç–æ –≤—Ä—É—á–Ω—É—é, –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–æ–∑–≤–æ–ª—å—Ç–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É —Å–¥–µ–ª–∞—Ç—å –æ—Å—Ç–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –∑–∞
–≤–∞—Å.

–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ –∫–∞–∫ _"–û! –¶–µ–Ω–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç DOM –Ω–æ–≤–æ–π —Ü–µ–Ω–æ–π –∏ –æ–±–Ω–æ–≤–∏—Ç—å –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ
–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —ç—Ç–æ–π —Ü–µ–Ω—ã"_.

## –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –º—ã –ø—ã—Ç–∞–µ–º—Å—è —Ä–µ—à–∏—Ç—å?

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä. –£ –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç `price` –∏ `quantity`. –ò –µ—Å—Ç—å –µ—â–µ –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `totalPrice`,
–∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ `price` –∏ `quantity`.

```js
let product = {price = 20, quantity: 5}
let totalPrice = product.price * product.quantity

console.log(totalPrice) // Returns 100
```

–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –º—ã –∏–∑–º–µ–Ω–∏–º —Ü–µ–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∞, –æ–±—â–∞—è —Ü–µ–Ω–∞ –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è.

```js
product.price = 30
console.log(totalPrice) // Still returns 100
```

–ù–∞–º –Ω—É–∂–µ–Ω —Å–ø–æ—Å–æ–± —Å–∫–∞–∑–∞—Ç—å –Ω–∞—à–µ–º—É –∫–æ–¥—É: "–≠–π, `totalPrice` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `price` –∏ `quantity`. –í—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∫–∞–∫–∞—è-–ª–∏–±–æ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
–∏–∑–º–µ–Ω—è–µ—Ç—Å—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å `totalPrice`".

–ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –º—ã –º–æ–∂–µ–º –æ–±–µ—Ä–Ω—É—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, `totalPrice` –≤ —Ñ—É–Ω–∫—Ü–∏—é `updateTotalPrice` –∏ –≤—ã–∑—ã–≤–∞—Ç—å –µ–µ –ø—Ä–∏
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

```js
function updateTotalPrice() {
    totalPrice = product.price * product.quantity
}

product.price = 30
updateTotalPrice()

console.log(totalPrice) // Now it returns 150
```

–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å `updateTotalPrice` —Ñ—É–Ω–∫—Ü–∏—é –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è `price` –∏–ª–∏ `quantity`. –ù–æ –≤—ã–∑—ã–≤–∞—Ç—å –µ–≥–æ
–≤—Ä—É—á–Ω—É—é –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω–æ, –Ω–∞–º –Ω—É–∂–µ–Ω —Å–ø–æ—Å–æ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–∑–Ω–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, –∏ 
—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤—ã–∑–≤–∞—Ç—å `updateTotalPrice` —Ñ—É–Ω–∫—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ò –∑–¥–µ—Å—å –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç **Javascript Proxy**.

## –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Javascript-–ø—Ä–æ–∫—Å–∏

–û–±—ä–µ–∫—Ç **Proxy** –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ
–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

- **target**: –∫–∞–∫–æ–π –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç –Ω–∞–º –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ–∫—Å–∏.
- **handler**: –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞: –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∫—Å–∏ —Å –ø—É—Å—Ç—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –æ–±—ä–µ–∫—Ç–æ–≤, –ø—Ä–æ–∫—Å–∏, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏—á–µ–≥–æ
–Ω–µ –¥–µ–ª–∞–µ—Ç. –û–Ω –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç.

```js
let product = {price: 20, quantity: 5}
let proxiedProduct = new Proxy(product, {})

console.log(proxiedProduct.price) // Returns 20

proxiedProduct.price = 50
console.log(product.price) // Returns 50
```

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–º console.log –ø–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π
–∑–Ω–∞—á–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—É—Ç–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `get` –∏ `set` —Ñ—É–Ω–∫—Ü–∏–π –≤ –æ–±—ä–µ–∫—Ç–µ-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –ø—Ä–æ–∫—Å–∏.

**get —Ñ—É–Ω–∫—Ü–∏—è**: —ç—Ç–æ –ª–æ–≤—É—à–∫–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

- **target**: –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç
- **property**: —Å–≤–æ–π—Å—Ç–≤–æ, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å
- **receiver**: –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –≤—ã–∑–≤–∞–Ω, –æ–±—ã—á–Ω–æ —Å–∞–º –ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç –∏–ª–∏ –ª—é–±–æ–π —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç (–º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –±—É–¥–µ–º –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç)

**set —Ñ—É–Ω–∫—Ü–∏—è**: –ª–æ–≤—É—à–∫–∞ –¥–ª—è –∑–∞–¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –æ–±—ä–µ–∫—Ç–æ–º –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 4 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

- **target**: –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç
- **property**: —Å–≤–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–º—É –º—ã –ø—ã—Ç–∞–µ–º—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
- **value**: –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–º –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
- **receiver**: –¢–æ –∂–µ, —á—Ç–æ –∏ get—Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –ø–æ–∫–∞ –Ω–µ –±—É–¥—É –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

```js
let product = {price: 20, quantity: 5}

let proxiedProduct = new Proxy(product, {
    get(target, property){
        console.log(`Getting value of ${property}`);
        return target[property]
    },

    set(target, property, value){
        console.log(`Setting value of ${property} to ${value}`);
        target[property] = value
        return true
    }
})

console.log(proxiedProduct.price) 
// Prints "Getting value of price"
// Then, Returns 20

proxiedProduct.price = 50  
// Prints "Setting value of price to 50"
// Then, Set value of product.price to 50
```

## –£–ª—É—á—à–µ–Ω–∏–µ 1: updateTotalPrice —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑–æ–≤–∞ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç—Ç–µ—Ä–∞

–í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –Ω–∞–º –Ω—É–∂–µ–Ω –±—ã–ª —Å–ø–æ—Å–æ–± —Å–∫–∞–∑–∞—Ç—å "–≠–π, –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ `price` –∏–ª–∏ `quantity` –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑—ã–≤–∞—Ç—å 
`updateTotalPrice` —Ñ—É–Ω–∫—Ü–∏—é". –≠—Ç–æ –∫–∞–∑–∞–ª–æ—Å—å –∫–∞–∫–∏–º-—Ç–æ –≤–æ–ª—à–µ–±—Å—Ç–≤–æ–º, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø—Ä–æ–∏–∑–æ—à–ª–æ. –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å
–µ—Å—Ç—å —Å–ø–æ—Å–æ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞. –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –≤—ã–∑–≤–∞—Ç—å **updateTotalPrice —Ñ—É–Ω–∫—Ü–∏—é** –≤–Ω—É—Ç—Ä–∏ –Ω–∞—à–µ–≥–æ —Å–µ—Ç—Ç–µ—Ä–∞.

```js
let proxiedProduct = new Proxy(product, {
    get(target, property){
        // Let's keep the getter empty for now
    },

    set(target, property, value){
        target[property] = value;

        if(property === "price") updateTotalPrice();
        if(property === "quantity") updateTotalPrice();

        return true;    
    }
})
```

–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ. –ï—Å–ª–∏ –º—ã –æ–±–Ω–æ–≤–∏–ª–∏ —Ü–µ–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∞, `totalPrice` –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

```js
console.log(totalPrice) // Returns 100

proxiedProduct.price = 30
console.log(totalPrice) //Returns 150 üéâ
```

–ù–∞–º –Ω–µ –Ω—É–∂–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ,
`price` –Ω–∞–ø—Ä–∏–º–µ—Ä, –±—ã–ª–æ 20, –∏ –º—ã —Ç–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 20. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ—Ç —Å–º—ã—Å–ª–∞, `totalPrice` –Ω–µ
–∏–∑–º–µ–Ω–∏–ª—Å—è. –ü–æ—ç—Ç–æ–º—É –Ω–µ–º–Ω–æ–≥–æ –∏–∑–º–µ–Ω–∏–º –∫–æ–¥:

```js
let proxiedProduct = new Proxy(product, {
    get(target, property){
        // Let's keep the getter empty for now
    },

    set(target, property, value){
        let oldValue = target[property];
        target[property] = value;

        // Call update function only if the value changed
        if( oldValue !== value ) {
            if(property === "price") updateTotalPrice();
            if(property === "quantity") updateTotalPrice();
        }

        return true;    
    }
})
```

## –£–ª—É—á—à–µ–Ω–∏–µ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π depsMap

–í –¥—Ä—É–≥–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ —É –Ω–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `updatePriceAfterDiscount`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç `price` –∏ –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è
–ø—Ä–∏ `price` –∏–∑–º–µ–Ω–µ–Ω–∏–∏. –ó–¥–µ—Å—å –Ω–∞—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–∞–º –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—à —Å–µ—Ç—Ç–µ—Ä, —á—Ç–æ–±—ã —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è
—Å —ç—Ç–∏–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–º.

```js
if(property === "price"){
    updateTotalPrice();
    updatePriceAfterDiscount();
}

if(property === "quantity") updateTotalPrice();
```

–ß—Ç–æ, –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π, –∑–∞–≤–∏—Å—è—â–∏—Ö –æ—Ç –∫–∞–∫–∏—Ö-—Ç–æ —Å–≤–æ–π—Å—Ç–≤? –ù–∞–º –Ω–µ –Ω—É–∂–Ω–æ —Ç—Ä–æ–≥–∞—Ç—å —Å–µ—Ç—Ç–µ—Ä –∏ –≥–µ—Ç—Ç–µ—Ä
–Ω–∞—Å—Ç–æ–ª—å–∫–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –∏ –ø–æ–∑–≤–æ–ª–∏—Ç—å –µ–º—É –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü–æ—ç—Ç–æ–º—É –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –≤—ã–¥–µ–ª–∏—Ç—å
—Å–≤–æ–π—Å—Ç–≤–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ.

–ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –¥–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º **–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ä–º–∏–Ω—ã**, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç vue, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –º—ã —Å—Ç—Ä–æ–∏–º.

- –§—É–Ω–∫—Ü–∏—è `updateTotalPrice` –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—ç—Ñ—Ñ–µ–∫—Ç–æ–º**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –∏–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
- –°–≤–æ–π—Å—Ç–≤–∞ `price` –∏ `quantity` –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ `updateTotalPrice` —ç—Ñ—Ñ–µ–∫—Ç–∞. –¢–∞–∫ –∫–∞–∫ –æ—Ç –Ω–∏—Ö –∑–∞–≤–∏—Å–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç.
- `updateTotalPrice` —ç—Ñ—Ñ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–º –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, —Ç.–µ. `updateTotalPrice` —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–º `price` –∏ `quantity`

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –∑–Ω–∞–µ–º —Ç–µ—Ä–º–∏–Ω—ã, –º—ã —Å–æ–∑–¥–∞–¥–∏–º –∫–∞—Ä—Ç—É `depsMap` –∫–æ—Ç–æ—Ä–∞—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º
—Å–ø–∏—Å–∫–æ–º —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ `price` —Å–≤–æ–π—Å—Ç–≤–æ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ `updateTotalPrice` –∏ –¥–ª—è `upadtePriceAfterDiscount`.
–ü—Ä–∏ –∫–∞–∂–¥–æ–º `price` –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã.

–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å–µ—Ç—Ç–µ—Ä `depsMap`, —á—Ç–æ–±—ã –∏–∑–≤–ª–µ—á—å –≤—ã–≥–æ–¥—É –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ú—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å
—Å–ø–∏—Å–æ–∫ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞—Ü–∏–∫–ª–∏—Ç—å –∏—Ö, –≤—ã–ø–æ–ª–Ω–∏–≤ –∏—Ö –≤—Å–µ —Å—Ä–∞–∑—É.

```js
let proxiedProduct = new Proxy(product, {
    get(target, property){
        // Let's keep the getter empty for now
    },

    set(target, property, value){
        let oldValue = target[property];
        target[property] = value;

        // Call update function only if the value changed
        if( oldValue != value ) {
            // Get list of effects of dependency
            let dep = depsMap.get(property)

            // Run all the effects of this dependency
            dep.forEach(effect => {
                effect()
            })
        }

        return true;
    }
})
```

–¢–µ–ø–µ—Ä—å –≤—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å `depsMap`, –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏.

–î–æ —Å–∏—Ö –ø–æ—Ä —ç—Ç–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–æ, –ø–æ–∫–∞ —É –Ω–∞—Å –Ω–µ –ø–æ—è–≤–∏–ª–æ—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –ï—Å–ª–∏ –º—ã –µ—â–µ —Ä–∞–∑ –≤–∑–≥–ª—è–Ω–µ–º –Ω–∞
–æ–±—ä–µ–∫—Ç `depsMap`, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π—Å—Ç–≤–∞ `product` –æ–±—ä–µ–∫—Ç–∞. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ —Å–ª–æ–∂–Ω–µ–µ. –ú—ã –∏–º–µ–µ–º –¥–µ–ª–æ –Ω–µ —Å
–æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º, –∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏, –∏ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤—Å–µ –æ–Ω–∏ –±—ã–ª–∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ —É –Ω–∞—Å
–µ—Å—Ç—å –¥—Ä—É–≥–æ–π –æ–±—ä–µ–∫—Ç, `user` –∏ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –æ–Ω —Ç–æ–∂–µ –±—ã–ª —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º. –ù–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π `depsMap` –¥–ª—è `user` –æ–±—ä–µ–∫—Ç–∞,
–æ—Ç–ª–∏—á–Ω–æ–≥–æ –æ—Ç –æ–±—ä–µ–∫—Ç–∞ `product`. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π —Å–ª–æ–π `targetMap`.

## –£–ª—É—á—à–µ–Ω–∏–µ 3: –°–æ–∑–¥–∞–Ω–∏–µ targetMap

–ú—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å `depsMap` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–µ–Ω —Å–ø–æ—Å–æ–± —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º
–æ–±—ä–µ–∫—Ç–æ–º –∏ –µ–≥–æ `depsMap`. –ò—Ç–∞–∫, –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É, `targetMap` –≥–¥–µ –∫–ª—é—á - —ç—Ç–æ —Å–∞–º —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∞ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ - —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ `depsMap` —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

–ù–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∫–ª—é—á –±—ã–ª –≤ `targetMap` —Å–∞–º–∏–º —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–æ–π.

–ü–æ—ç—Ç–æ–º—É –º—ã –Ω–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—É—é –∫–∞—Ä—Ç—É –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è `targetMap`, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
javascript **WeakMap**. WeakMaps - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–∞—Ä—ã –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–∏–µ (–æ–±—ã—á–Ω—ã–π –æ–±—ä–µ–∫—Ç), –≥–¥–µ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–∞–º–∏, –∞
–∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º –¥–æ–ø—É—Å—Ç–∏–º—ã–º —Ç–∏–ø–æ–º javascript. –ù–∞–ø—Ä–∏–º–µ—Ä:

```js
const product = {price: 20, quantity: 5};
const wm = new WeakMap(),;
wm.set(product, "this is the value");

wm.get(product) // Returns "this is the value"
```

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –∑–Ω–∞–µ–º, –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∞–π–ª `targetMap` –Ω–∞–º —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞—à —Å–µ—Ç—Ç–µ—Ä, —Ç–∞–∫ –∫–∞–∫ —Ç–µ–ø–µ—Ä—å –º—ã –∏–º–µ–µ–º –¥–µ–ª–æ
—Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ `depsMaps` –∏ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `depsMap`. –¢–∞–∫ –∫–∞–∫ –≤ —Å–µ—Ç—Ç–µ—Ä–µ –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç. –ú—ã
–º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à `targetMap`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

```js
let proxiedProduct = new Proxy(product, {
    get(target, property){
        // Let's keep the getter empty for now
    },

    set(target, property, value){
        let oldValue = target[property];
        target[property] = value;

        // Call update function only if the value changed
        if( oldValue != value ) {
            // We get the correct depsMap using the target (reactive object)
            let depsMap = targetMap.get(target)
            if(!depsMap) return

            // Get list of effects of dependency
            let dep = depsMap.get(property)
            if(!dep) return

            // Run all the effects of this dependency
            dep.forEach(effect => {
                effect()
            })
        }

        return true;
    }
})
```

## –ü–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤

–î–æ —Å–∏—Ö –ø–æ—Ä –º—ã —Å–æ–∑–¥–∞–ª–∏ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—é —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –ø—Ä–æ–∫—Å–∏. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
—Å–≤–æ–π—Å—Ç–≤–∞. –ü–æ—ç—Ç–æ–º—É —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `triggerVue`.

–î–∞–≤–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–∏–º –≤—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ –º—ã –¥–æ–±–∞–≤–∏–º –Ω–æ–≤—É—é
—Ä–µ–∞–∫—Ç–∏–≤–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `priceAfterDiscount`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç `price` —Å–≤–æ–π—Å—Ç–≤–∞.

1. –í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º –Ω–∞—à–∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã.

```js
let product = { price: 20, quantity: 5 };
let totalPrice = product.price * product.quantity;
let priceAfterDiscount = product.price * 0.9;

// Effects
function updateTotalPrice() {
 totalPrice = product.price * product.quantity;
}

function updatePriceAfterDiscount() {
 priceAfterDiscount = product.price * 0.9;
}
```

2. –í–æ-–≤—Ç–æ—Ä—ã—Ö, –¥–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º –∏ –∑–∞–ø–æ–ª–Ω–∏–º `targetMap` –∏ `depMap`

```js
const targetMap = new WeakMap();
const productDepsMap = new Map();

targetMap.set(product, productDepsMap);

productDepsMap.set('price', [updateTotalPrice, updatePriceAfterDiscount]);
productDepsMap.set('quantity', [updateTotalPrice]);
```

3. –ù–∞–∫–æ–Ω–µ—Ü, –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è `product` –æ–±—ä–µ–∫—Ç–∞.

```js
// Creating the Proxied Product
let proxiedProduct = new Proxy(product, {
 get(target, property) {
   // Let's keep the getter empty for now
 },

 set(target, property, value) {
   // ... same as we've defined it in the previous section
 },
});
```

4. –í—É–∞–ª—è, –Ω–∞—à `product` –æ–±—ä–µ–∫—Ç —Ç–µ–ø–µ—Ä—å —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π

```js
console.log(totalPrice); // Returns 100
console.log(priceAfterDiscount); // Returns 18

// totalPrice and priceAfterDiscount should be updated on updating price
proxiedProduct.price = 30;

console.log('‚úÖ After Updating Price');
console.log(totalPrice); // Returns 150
console.log(priceAfterDiscount); // Returns 27

// only totalPrice should be updated on updating quantity
proxiedProduct.quantity = 10;

console.log('‚úÖ After Updating Quantity');
console.log(totalPrice); // Returns 300
console.log(priceAfterDiscount); // Still Returns 27
```